# üóÑÔ∏è –†–∞–±–æ—Ç–∞ —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## üìã –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –º–∏–≥—Ä–∞—Ü–∏–π:

#### üîÑ **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π:**
```bash
make db-migrate          # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å)
make db-migrate-dev      # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ development
make db-migrate-prod     # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ production
```

#### üìù **–°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π:**
```bash
make db-migrate-create MIGRATION_NAME=add_user_table
# –°–æ–∑–¥–∞—Å—Ç –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é —Å –∏–º–µ–Ω–µ–º "add_user_table"
```

#### üìä **–°—Ç–∞—Ç—É—Å –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```bash
make db-migrate-status   # –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–π
make db-migrate-reset    # –°–±—Ä–æ—Å–∏—Ç—å –ë–î –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏
```

### üîß **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã Prisma:**

#### üéØ **–†–∞–±–æ—Ç–∞ —Å–æ —Å—Ö–µ–º–æ–π:**
```bash
make db-generate         # –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Prisma –∫–ª–∏–µ–Ω—Ç
make db-push            # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã –±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–π
make db-pull            # –ò–∑–≤–ª–µ—á—å —Å—Ö–µ–º—É –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –ë–î
```

#### üé® **Prisma Studio:**
```bash
make db-studio          # –û—Ç–∫—Ä—ã—Ç—å Prisma Studio (development)
make db-studio-prod     # –û—Ç–∫—Ä—ã—Ç—å Prisma Studio (production)
```

#### üå± **–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:**
```bash
make db-seed            # –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ë–î —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
```

### üíæ **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:**

#### üì§ **–°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞:**
```bash
make db-backup          # –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –ë–î
# –°–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª: backup_YYYYMMDD_HHMMSS.sql
```

#### üì• **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ:**
```bash
make db-restore BACKUP_FILE=backup_20241201_143022.sql
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ë–î –∏–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
```

### üñ•Ô∏è **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º:**

#### üîß **Backend –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:**
```bash
make dev-shell          # –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ development backend
make dev-shell-prod     # –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ production backend
```

#### üóÑÔ∏è **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
```bash
make dev-shell-db       # –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ PostgreSQL
```

## üöÄ **–¢–∏–ø–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

### 1. **–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏:**
```bash
# 1. –ò–∑–º–µ–Ω–∏—Ç–µ schema.prisma
# 2. –°–æ–∑–¥–∞–π—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é
make db-migrate-create MIGRATION_NAME=add_new_feature

# 3. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é
make db-migrate-dev
```

### 2. **–ë—ã—Å—Ç—Ä–æ–µ –ø—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```bash
# –ò–∑–º–µ–Ω–∏—Ç–µ schema.prisma –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–π
make db-push
```

### 3. **–°–±—Ä–æ—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:**
```bash
# –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –≤—Å–µ—Ö –º–∏–≥—Ä–∞—Ü–∏–π
make db-migrate-reset
```

### 4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞:**
```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–∞–∫–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
make db-migrate-status
```

### 5. **–†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏:**
```bash
# –û—Ç–∫—Ä—ã—Ç—å Prisma Studio –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
make db-studio

# –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
make db-seed
```

## ‚ö†Ô∏è **–í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è:**

### üîí **Production:**
- –í—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ development
- –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –≤ production
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `make db-migrate-prod` –¥–ª—è production

### üõ°Ô∏è **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- –ö–æ–º–∞–Ω–¥–∞ `db-migrate-reset` —É–¥–∞–ª—è–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
- –í—Å–µ–≥–¥–∞ –¥–µ–ª–∞–π—Ç–µ –±—ç–∫–∞–ø –ø–µ—Ä–µ–¥ –≤–∞–∂–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `make db-backup` –ø–µ—Ä–µ–¥ —Å–±—Ä–æ—Å–æ–º

### üéØ **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `db-push` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏—è
- –°–æ–∑–¥–∞–≤–∞–π—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–π —Ä–µ–≥—É–ª—è—Ä–Ω–æ

## üìÅ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤:**

```
applications/techmage-backend/
‚îú‚îÄ‚îÄ src/database/prisma/
‚îÇ   ‚îú‚îÄ‚îÄ schema.prisma          # –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ migrations/            # –ü–∞–ø–∫–∞ —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏
‚îÇ       ‚îú‚îÄ‚îÄ 20241201_143022_add_user_table/
‚îÇ       ‚îî‚îÄ‚îÄ 20241201_150000_add_posts_table/
‚îî‚îÄ‚îÄ backup_YYYYMMDD_HHMMSS.sql # –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏
```

## üîó **–ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏:**

- [Prisma Migrate Guide](https://www.prisma.io/docs/concepts/components/prisma-migrate)
- [Prisma Studio](https://www.prisma.io/docs/concepts/components/prisma-studio)
- [PostgreSQL Documentation](https://www.postgresql.org/docs/)
